(function(c,d){var b=Fai.top.$("body");var a=false;d.drawLottery=function(){if(a){return}var n=d.isTenMinutes;if(typeof c("#countDownLeft")!="undefined"&&c("#countDownLeft").html()!="undefined"){i("#countDownLeft")}if(d.isShowThreeDaysLuckyGuy=="true"){if(n=="true"&&(d.getCookieFlag(0)||!d.siteFirstLogin)){b.append(g());i(".timeCountDown");Fai.top.Fai.bodyBg("DrawLottery",0.6)}}else{var q=c.cookie("_hasGetLuckyGuy_",{path:"/"});if(d.isShowThreeDaysLuckyGuySmall!="true"&&q!="true"){d.logDog(200031,7);b.append(f());Fai.top.Fai.bodyBg("DrawLottery",0.6)}}var p=b.children(".J_drawLottery");var l=p.find(".J_lotteryCommit");var s=p.find(".dl_light");var o=0;var r=s.eq(0);var m=setInterval(function(){if(o%2==0){r.addClass("dl_light_on")}else{r.removeClass("dl_light_on")}o+=1},550);l.on("click.lottery",function(){clearInterval(m);c(".dl_commitPrompt").css("display","none");if(d.isShowThreeDaysLuckyGuy=="true"){c(".J_lotteryCommit").css("background","url("+d.threeDaysGrabBtn+") no-repeat 2px -118px");c(".J_lotteryCommit").attr("href","javaScript:void(0);")}c(".J_lotteryCommit").attr("_hasClick","1");c.cookie("hasShowSalesPromotion","true",{expires:7,path:"/"});if(!a){a=true;var u=new Date().getTime()+3000;var t=setInterval(function(){s.removeClass("dl_light_on").eq(e(0,3)).addClass("dl_light_on");if(h(u)){clearInterval(t);s.removeClass("dl_light_on").eq(3).addClass("dl_light_on");setTimeout(function(){if(d.isShowThreeDaysLuckyGuy=="true"&&n=="true"){d.sendResult2()}else{if(d.isShowThreeDaysLuckyGuySmall!="true"){d.sendResult()}}},1000)}},50)}});p.find(".J_drawLotteryClose").click(function(){var t=".navbar_right .upgrade";if(Fai.top._Global._topBarV2){t="#toolbarRight .admTool-buyUpgrade"}Fai.closePopupWindowAnimate(p,t);p.remove();Fai.top.Fai.removeBodyBg("DrawLottery");d.logDog(200031,11);c.cookie("hasShowSalesPromotion","true",{expires:7,path:"/"})})};c(function(){if(c.cookie("hasShowSalesPromotion")!="true"){d.drawLottery()}});function f(){var n="100";var m=[10,30,50,100];var p=[];p.push("<div class='J_drawLottery drawLottery drawLottery"+n+"'>");p.push("	<div class='dl_title'>");p.push("		<p>恭喜您获得老用户抽奖资格。限时红包开抢啦！</p>");p.push("	</div>");p.push("	<div class='dl_content'>");for(var o=0,l=m.length-1;o<l;o++){p.push("		<div class='dl_redPaper'>");p.push("			<div class='dl_money dl_money"+m[o]+"'>"+m[o]+"元</div>");p.push("			<div class='dl_light'></div>");p.push("		</div>")}p.push("		<div class='dl_redPaper dl_redPaper_end'>");p.push("			<div class='dl_money dl_money"+m[m.length-1]+"'>"+m[m.length-1]+"元</div>");p.push("			<div class='dl_light'></div>");p.push("		</div>");p.push("	</div>");p.push("	<div class='dl_commitContainer'>");p.push("		<a href='javascript:;' hidefocus='true' class='J_lotteryCommit dl_commit' onclick='Site.logDog(200031,8);'>马上抢</a>");p.push("		<p class='dl_commitPrompt'>点击按钮抽取红包，快来试试你的运气！</p>");p.push("	</div>");p.push("	<div class='dl_prompt'>");p.push("		<p>限抢一次</p>");p.push("	</div>");p.push("	<a href='javascript:;' hidefocus='true' class='J_drawLotteryClose dl_close' title='关闭'>关闭</a>");p.push("</div>");return p.join("")}function g(){var n="100";var m=[10,30,50,100];var p=[];p.push("<div class='J_drawLottery drawLottery drawLottery"+n+"' style='box-shadow: none;background:url("+d.threeDaysImgBig+") center no-repeat;'>");p.push("	<div class='dl_title' style='display:block; font-size:28px; margin-left:50px; margin-top:15px;'>");p.push("		<p>新员专享</p>");p.push("	</div>");p.push("	<div class='dl_content'>");for(var o=0,l=m.length-1;o<l;o++){p.push("		<div class='dl_redPaper' style='background:none;'>");p.push("			<div class='dl_light'></div>");p.push("		</div>")}p.push("		<div class='dl_redPaper dl_redPaper_end' style='background:none; width:146px;'>");p.push("			<div class='dl_light'></div>");p.push("		</div>");p.push("	</div>");p.push("	<div class='timeCountDown' style='font-size:20px; font-family:微软雅黑; position:absolute; top:360px;width:100%; text-align:center;'></div>");p.push("	<div class='dl_commitContainer' style='margin-top:29px;'>");p.push("		<a href='javascript:;' hidefocus='true' class='J_lotteryCommit dl_commit' style='background:url("+d.threeDaysGrabBtn+") no-repeat 0px -3px; width:202px; height:91px;'>马上抢</a>");p.push("	</div>");p.push("	<a href='javascript:;' hidefocus='true' class='J_drawLotteryClose dl_close' title='关闭' style='background:url("+d.threeDaysGrabBtn+") no-repeat -2px -287px; width:41px; height:40px;'>关闭</a>");p.push("</div>");return p.join("")}function j(m){var o=[];var u="截止至"+m.year+"年"+m.month+"月"+m.day+"日。";var v=[];var s="gl_content2";var t="gl_useIt2";var q="";var l=1;if(m.flag==50){q="getLottery50";v.push("1、现金券可购买任意网站版本;");v.push("2、有效期为5天，请尽快使用")}else{if(m.flag==100){q="getLottery100";v.push("现金券可购买任意网站版本;");v.push("有效期为5天，"+u+"")}}o.push("<div class='J_getLottery getLottery "+q+"'>");o.push("	<div class='gl_content "+s+"'>");o.push("		<div class='gl_dateContent'>");o.push("			<p class='gl_dateTitle'>使用日期：</p>");o.push("			<p class='gl_dateMsg'>"+u+"</p>");o.push("		</div>");o.push("		<div class='gl_useContent'>");o.push("			<p class='gl_useTitle'>使用说明：</p>");for(var n=0,p=v.length;n<p;n++){o.push("		<p class='gl_useMsg'>"+v[n]+"</p>")}o.push("		</div>");o.push("		<a href='http://"+Fai.top._portalHost+"/portal.jsp?_f=4&useLottery=1&coupon="+l+"#appId=shop' hidefocus='true' class='gl_useIt gl_useIt2' onclick='Site.logDog(200031,9);' target='_blank'>立即使用红包</a>");o.push("	</div>");o.push("	<a href='javascript:;' hidefocus='true' class='J_getLotteryClose gl_close' title='关闭'>关闭</a>");o.push("</div>");b.append(o.join(""));var r=b.find(".J_getLottery");r.find(".J_getLotteryClose").click(function(){var w=".navbar_right .upgrade";if(Fai.top._Global._topBarV2){w="#toolbarRight .admTool-buyUpgrade"}Fai.closePopupWindowAnimate(r,w);c.cookie("hasShowSalesPromotion","true",{expires:7,path:"/"});d.logDog(200031,11);r.remove();Fai.top.Fai.removeBodyBg("DrawLottery")});r.find(".gl_useIt").click(function(){var w=".navbar_right .upgrade";if(Fai.top._Global._topBarV2){w="#toolbarRight .admTool-buyUpgrade"}Fai.closePopupWindowAnimate(r,w);c.cookie("hasShowSalesPromotion","true",{expires:7,path:"/"});r.remove();Fai.top.Fai.removeBodyBg("DrawLottery")})}function k(m){var o=[];var u=m.month+"月"+m.day+"日";var v=[];var s="gl_content2";var t="gl_useIt2";var q="";var l=1;if(m.flag==50){q="getLottery50";v.push("1.现金券可以购买任意网站版本");v.push("2.现金券有效期为<span style='color:#fede29; font-size:24px; font-weight:bold;'>3</span>天，请尽快使用")}else{if(m.flag==100){q="getLottery100";v.push("1.现金券可以购买任意网站版本");v.push("2.现金券有效期为<span style='color:#fede29; font-size:24px; font-weight:bold;'>3</span>天，请尽快使用")}}o.push("<div class='J_getLottery getLottery "+q+"' style='box-shadow:none; background:url("+d.threeDaysLuckyGuy+") center no-repeat;'>");o.push("	<div class='gl_content "+s+"' style='padding-top:176px; padding-left:260px;'>");o.push("		<div class='gl_dateContent' style='height:30px;'>");o.push("			<p class='gl_dateTitle' style='font-size:30px; width:295px; color:#fff; text-align:center; line-height:30px;'>恭喜您</p>");o.push("		</div>");o.push("		<div class='gl_useContent' style='height:30px; margin-top:25px; margin-left:33px;'>");o.push("			<p class='gl_useTitle' style='font-size:22px; color:#fff;'>获得一张&nbsp<span style='font-weight:bold; color:#fede29;'>100元</span>&nbsp现金券</p>");o.push("		</div>");o.push("		<a href='http://"+Fai.top._portalHost+"/portal.jsp?useLottery=1&coupon="+l+"&_f=4#appId=shop' hidefocus='true' class='gl_useIt gl_useIt2' style='background:url("+d.threeDaysUseBtn+") center no-repeat; width:295px; height:67px' target='_blank' onclick=\"$('.J_getLottery').find('.J_getLotteryClose').click();\">立即使用红包</a>");o.push("		<div class='remark' style='font-size:14px; color:#fff; margin-top:35px;'>");o.push("			<p>使用期限：截止至2016年"+u+"</p>");o.push("			<p style='float:left;'>使用说明：</p>");for(var n=0,p=v.length;n<p;n++){o.push("		<p class='gl_useMsg'>"+v[n]+"</p>")}o.push("		</div>");o.push("	</div>");o.push("	<a href='javascript:;' hidefocus='true' class='J_getLotteryClose gl_close' title='关闭' style='background:url("+d.threeDaysGrabBtn+") no-repeat -2px -287px; width:41px; height:40px; top:-10px; right:200px;'>关闭</a>");o.push("</div>");b.append(o.join(""));var r=b.find(".J_getLottery");r.find(".J_getLotteryClose").click(function(){c(".navbar_right .upgrade").css("background","#4291d7");c(".navbar_right .upgrade").css("color","#d6ebfe");c(".J_getLottery").hide();c(".J_drawLottery").hide()})}d.sendResult=function(){c.ajax({type:"post",url:"../ajax/log_h.jsp?cmd=lottery",data:"",error:function(){Fai.ing("系统繁忙，请稍候重试",true)},success:function(l){var n=c.parseJSON(l);b.children(".J_drawLottery").remove();Fai.top.$("#topBarArea").find(".J_drawLotteryMsg").remove();if(n.success){if(typeof n.rt!="undefined"&&n.rt==0){if(typeof n.info!="undefined"){if(n.info.type==15){var m=0;if(n.info.price==50){m=50}else{if(n.info.price==100){m=100}}j({flag:m,day:n.info.day,month:n.info.month,year:n.info.year});d.logDog(200031,7)}else{Fai.top.Fai.removeBodyBg("DrawLottery");Fai.ing(n.msg,false)}}else{Fai.top.Fai.removeBodyBg("DrawLottery");Fai.ing(n.msg,false)}}else{Fai.top.Fai.removeBodyBg("DrawLottery");Fai.ing(n.msg,false)}}else{Fai.top.Fai.removeBodyBg("DrawLottery");Fai.ing(n.msg,false)}}})};d.sendResult2=function(){c.ajax({type:"post",url:"../ajax/log_h.jsp?cmd=luckyGuy",data:"",error:function(){Fai.ing("系统繁忙，请稍候重试",true)},success:function(l){var n=c.parseJSON(l);b.children(".J_drawLottery").remove();Fai.top.$("#topBarArea").find(".J_drawLotteryMsg").remove();if(n.success){if(typeof n.rt!="undefined"&&n.rt==0){if(typeof n.info!="undefined"){if(n.info.type==15){var m=0;if(n.info.price==50){m=50}else{if(n.info.price==100){m=100}}k({flag:m,day:n.info.day,month:n.info.month,year:n.info.year})}else{Fai.top.Fai.removeBodyBg("DrawLottery");Fai.ing(n.msg,false)}}else{Fai.top.Fai.removeBodyBg("DrawLottery");Fai.ing(n.msg,false)}}else{Fai.top.Fai.removeBodyBg("DrawLottery");if(n.msg=="你已经抢到过红包了。"){Fai.top.Fai.bodyBg("DrawLottery",0.6);k({flag:100,day:n.info.day,month:n.info.month})}else{Fai.ing(n.msg,false)}}}else{Fai.top.Fai.removeBodyBg("DrawLottery");Fai.ing(n.msg,false)}}})};function i(t){var o=0;var s;var q;var l;var r;var p;var n=new Date(d.threeDaysEndYear,d.threeDaysEndMonth-1,d.threeDaysEndDay,23,59,59);var m=setInterval(function(){o=n-(new Date());s=parseInt(o/1000/60/60/24,10);if(s>=3||o<=0){c("#countDownLeft").html("<a  class='freeJZ'  href='"+textUrl+"'  target='_blank'><span >了解更多</span></a>");c(".timeCountDown").html("促销已经结束!")}else{q=parseInt(o/1000/60/60%24,10);l=parseInt(o/1000/60%60,10);r=parseInt(o/1000%60,10);p=parseInt(o/100%10,10);if(t=="#countDownLeft"){c(t).html("仅剩"+s+"天"+q+"时"+l+"分"+r+"秒")}else{c(t).html("仅剩："+s+"天"+q+"时"+l+"分"+r+"秒")}}},100)}function e(p,l){var o=l-p+1;return Math.floor(Math.random()*o+p)}function h(l){return new Date().getTime()>l?true:false}})(jQuery,Site);